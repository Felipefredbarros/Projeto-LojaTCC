<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:composition template="../index.xhtml">
        <ui:define name="body">

            <div class="form-container">
                <h:form id="formUsuario">

                    <p:growl id="mensagemGrowl" showDetail="true" life="5000" escape="false" />
                    <p:focus context="formUsuario" />

                    <p:panel styleClass="form-card">
                        <f:facet name="header">
                            <div class="card-header">
                                <i class="pi pi-user-plus mr-2"/>
                                <span>Cadastro de Usuário</span>
                            </div>
                        </f:facet>

                        <p:panelGrid columns="2" layout="grid"
                                     styleClass="ui-panelgrid-blank ui-fluid form-grid"
                                     columnClasses="ui-grid-col-3 label-col, ui-grid-col-9 input-col">

                            <p:outputLabel for="funcionario" value="Funcionário:" styleClass="font-semibold"/>
                            <p:selectOneMenu id="funcionario"
                                             value="#{usuarioControle.usuario.pessoa}"
                                             converter="#{usuarioControle.pessoaConverter}"
                                             required="true"
                                             requiredMessage="É obrigatório selecionar um Funcionário."
                                             filter="true" filterMatchMode="contains">
                                <f:selectItem itemLabel="-- Selecione um funcionário --" itemValue="#{null}" noSelectionOption="true"/>
                                <f:selectItems value="#{usuarioControle.listaFuncionarios}"
                                               var="func"
                                               itemLabel="#{func.nome}"
                                               itemValue="#{func}"/>
                                <p:ajax event="change" update="mensagemGrowl"/>
                            </p:selectOneMenu>

                            <p:outputLabel for="login" value="Login:" styleClass="font-semibold"/>
                            <p:inputText id="login"
                                         value="#{usuarioControle.usuario.login}"
                                         maxlength="60"
                                         required="true"
                                         requiredMessage="O campo Login é obrigatório."
                                         placeholder="Ex: felipe.santos">
                                <p:ajax event="blur" update="mensagemGrowl"/>
                            </p:inputText>

                            <p:outputLabel for="senha" value="Senha:" styleClass="font-semibold"/>
                            <p:password id="senha"
                                        value="#{usuarioControle.usuario.senha}"
                                        feedback="true"
                                        toggleMask="true"
                                        inline="false"
                                        required="true"
                                        requiredMessage="O campo Senha é obrigatório."
                                        placeholder="Crie uma senha forte"
                                        weakLabel="Fraca" goodLabel="Boa" strongLabel="Forte"
                                        promptLabel="Digite uma senha"/>
                        </p:panelGrid>

                        <div class="form-actions">
                            <p:commandButton value="Salvar" icon="pi pi-check"
                                             action="listaUsuario.xhtml?faces-redirect=true"
                                             update="@form :formUsuario:mensagemGrowl"
                                             styleClass="ui-button-success"
                                             actionListener="#{usuarioControle.salvar()}"/>
                            <p:commandButton value="Cancelar" icon="pi pi-times"
                                             action="listaUsuario.xhtml?faces-redirect=true"
                                             immediate="true"
                                             styleClass="ui-button-secondary" />
                        </div>
                    </p:panel>
                </h:form>
            </div>

            <style type="text/css">
                /* Herdando variáveis do template para consistência */
                :root {
                    --primary-color: #007bff;
                    --primary-color-dark: #0056b3;
                    --secondary-color: #6c757d;
                    --dark-color: #212529;
                    --border-color: #dee2e6;
                    --border-radius: 6px;
                }

                .form-container {
                    max-width: 900px; /* Largura máxima para melhor legibilidade */
                    margin: 2rem auto; /* Centraliza o container */
                    padding: 1rem;
                }

                .form-card {
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
                    border: none;
                }

                /* Novo estilo para o cabeçalho do painel */
                .card-header {
                    display: flex;
                    align-items: center;
                    font-weight: 600;
                    font-size: 1.1rem;
                }

                .ui-panel .ui-panel-header {
                    background: #f8f9fa;
                    border-bottom: 1px solid var(--border-color);
                    color: var(--dark-color);
                    border-top-left-radius: 10px;
                    border-top-right-radius: 10px;
                }

                .ui-panel .ui-panel-content {
                    padding: 2rem; /* Mais espaçamento interno */
                }

                .form-grid .ui-panelgrid-cell {
                    padding: 0.75rem;
                    vertical-align: top; /* Alinha o label com o topo do input */
                }

                .label-col {
                    text-align: right;
                    padding-right: 1.5rem !important;
                    font-weight: 600;
                    color: #495057;
                }

                .ui-inputfield,
                .ui-selectonemenu,
                .ui-password {
                    width: 100%;
                    border-radius: var(--border-radius) !important;
                }

                .ui-selectonemenu .ui-selectonemenu-label {
                    border-radius: var(--border-radius) !important;
                }

                .ui-inputfield:focus,
                .ui-selectonemenu.ui-state-focus .ui-selectonemenu-label {
                    border-color: var(--primary-color) !important;
                    box-shadow: 0 0 0 1px var(--primary-color) !important;
                }

                /* Alinhamento dos botões */
                .form-actions {
                    display: flex;
                    justify-content: flex-end; /* Alinha botões à direita */
                    gap: 10px; /* Espaço entre os botões */
                    margin-top: 2rem;
                    padding-top: 1.5rem;
                    border-top: 1px solid #e9ecef;
                }
            </style>

        </ui:define>
    </ui:composition>
</html>